@page "/minhareserva/{ReservationId}"
@using System.Globalization
@inject NavigationManager navigationManager
@inject APICloudbeds cloudbedsAPI

@rendermode InteractiveAuto

<PageTitle>Reserva</PageTitle>

<MudPaper Class="px-8 pt-2 pb-4 mx-4 my-4 rounded-xl" Justify="Justify.Center">
    @if (reserva is not null)
    {
        @*  <MudToggleIconButton Align="Align.Center" Justify="Justify.Center" Icon="@Icons.Material.Filled.Check" Color="@Color.Success" Title="Off" Disabled="true" ToggledIcon="@Icons.Material.Filled.Cancel" ToggledColor="@Color.Error" ToggledTitle="On" /> *@
        <MudText Typo="Typo.h6" Align="Align.Center" GutterBottom="true">Agradecemos seu pedido!</MudText>
        <MudText Align="Align.Center"> O número da reserva é #@reserva.IDReserva  </MudText>
        <MudText Align="Align.Center"> Enviamos a confirmação do pedido para o e-mail: @reserva.Email  </MudText>
        <MudGrid Justify="Justify.Center">
            <MudItem xs="3">
                Check-in <br />
                @reserva.DataCheckIn.GetValueOrDefault().ToString("dd/MM/yyyy") <br />
                @reserva.DataCheckIn.GetValueOrDefault().ToString("dddd", new CultureInfo("pt-BR")) <br />
            </MudItem>
            <MudItem xs="1">
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
            </MudItem>
            <MudItem xs="3">
                Check-Out <br />
                @reserva.DataCheckOut.GetValueOrDefault().ToString("dd/MM/yyyy")  <br />
                @reserva.DataCheckOut.GetValueOrDefault().ToString("dddd", new CultureInfo("pt-BR"))  <br />
            </MudItem>
        </MudGrid>
        <MudText Align="Align.Center">
            <i class="fa-solid fa-moon"> </i> @reserva.Noites.GetValueOrDefault(1).ToString() Noite(s)
            <i class="fa fa-users" aria-hidden="true"></i> @reserva.Hospedes.GetValueOrDefault(1).ToString() Hospede(s)
        </MudText>
        
        <MudSpacer />
        <MudText Align="Align.Center" Class="mb-n4"> - </MudText>
        <MudForm Disabled="Disabled">
            @* <MudNumericField T="int" Label="Number" Disabled="true" @bind-Value="reserva.IDReserva" /> *@
            <MudTextField T="string" Label="Nome do Hospede Principal" Disabled="true" @bind-Value="reserva.NomeHospede" />
            <MudTextField T="string" Label="Origem" Disabled="true" @bind-Value="reserva.Origem" />
            @if (!string.IsNullOrEmpty(reserva.IDReservaAgencia))
            {
                <MudTextField T="string" Label="Número da reserva via agência" Disabled="true" @bind-Value="reserva.IDReservaAgencia" />
            }
        </MudForm>
        <MudSpacer />
        <br />
        <MudPaper Class="rounded-xl">
            <MudExpansionPanel Text="Acomodações" Style="background-color: #F5F4F4; rounded-xl" MaxHeight="150" Elevation="2">
                <MudPaper>
                    @reserva.ListaQuartos[0]!.Descricao
                </MudPaper>
            </MudExpansionPanel>
        </MudPaper>

    }
    else
    {
        <MudProgressCircular Indeterminate="true" Align="Align.Center" Justify="Justify.Center" />
    }
</MudPaper>


@code {
    [Parameter]
    public string ReservationId { get; set; }

    public Reserva reserva { get; set; }

    bool ReadOnly = true;
    bool NestedReadOnly;
    bool Disabled = true;
    bool NestedDisabled;

    protected override async Task OnInitializedAsync()
    {
        reserva = await cloudbedsAPI.GetReservaAsync(ReservationId);
    }
} 